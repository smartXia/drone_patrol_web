import{a as pe,A as me,T as fe,d as _e,r as $,_ as j,b as f,o as z,c as F,e as y,f as e,w as l,g as d,F as ye,h as ve,n as ae,t as N,i as B,j as ee,k as ge,l as be,m as E,u as te,p as ke,q as he,s as Z,v as we,x as J,y as xe,z as Ce,B as oe,E as H,C as $e,D as ze,G as Ne}from"./index-468fb462.js";const T=pe.create({baseURL:me,timeout:fe});let se={host:"127.0.0.1",port:6379,db:0,password:""};function Te(t){se={host:t.host,port:t.port,db:t.db||0,password:t.password||""}}function V(t={}){return{...se,...t}}async function Ve(t){const{data:n}=await T.post("/connect/test",t);return n}async function Se({cursor:t="0",match:n,count:a=100,type:o}){const{data:p}=await T.post("/scan",V({key:n,cursor:t,count:a,type:o}));return p}async function Ke(t){const{data:n}=await T.post("/metadata",V({key:t}));return n.data}async function Me(t,n){const{data:a}=await T.post("/expire",V({key:t,ttl:n}));return a.code===0}async function De(t){const{data:n}=await T.post("/persist",V({key:t}));return n.code===0}async function Le(t,n){const{data:a}=await T.post("/rename",V({key:t,newKey:n}));return a.code===0}async function Pe(t){const{data:n}=await T.post("/del",V({key:t}));return n.code===0}async function Re(t){const{data:n}=await T.post("/get",V({key:t}));return n.data.value}async function Be(t,n){const{data:a}=await T.post("/set",V({key:t,value:n}));return a.code===0}async function Fe(t,n=0,a=100){const{data:o}=await T.post("/hash/getall",V({key:t,offset:n,limit:a}));return o.data}async function Ie(t,n,a){const{data:o}=await T.post("/hash/set",V({key:t,field:n,value:a}));return o.code===0}async function Ue(t,n){const{data:a}=await T.post("/hash/del",V({key:t,field:n}));return a.code===0}async function Ee(t,n=0,a=100){const{data:o}=await T.post("/list/range",V({key:t,start:n,stop:a}));return o.data}async function Ae(t,n){const{data:a}=await T.post("/list/lpush",V({key:t,value:n}));return a.code===0}async function Oe(t,n){const{data:a}=await T.post("/list/rpush",V({key:t,value:n}));return a.code===0}async function He(t){const{data:n}=await T.post("/list/lpop",V({key:t}));return n.data.value}async function je(t){const{data:n}=await T.post("/list/rpop",V({key:t}));return n.data.value}async function qe(t,n,a){const{data:o}=await T.post("/list/set",V({key:t,index:n,value:a}));return o.code===0}async function Ge(t,n){const{data:a}=await T.post("/list/lrem",V({key:t,value:n}));return a.code===0}async function Ze(t,n="0",a,o=100){const{data:p}=await T.post("/set/scan",V({key:t,cursor:n,match:a,count:o}));return p.data}async function Je(t,n){const{data:a}=await T.post("/set/sadd",V({key:t,member:n}));return a.code===0}async function Qe(t,n){const{data:a}=await T.post("/set/srem",V({key:t,member:n}));return a.code===0}async function We(t,n=0,a=100){const{data:o}=await T.post("/zset/range",V({key:t,offset:n,limit:a}));return o.data}async function Xe(t,n,a){const{data:o}=await T.post("/zset/zadd",V({key:t,member:n,score:a}));return o.code===0}async function Ye(t,n){const{data:a}=await T.post("/zset/zrem",V({key:t,member:n}));return a.code===0}async function et(t,n,a){const{data:o}=await T.post("/zset/zincrby",V({key:t,member:n,increment:a}));return o.data.score}const tt=_e("redis",()=>{const t=$([]),n=$(null),a=$(!1),o=$(!1),p=$("*"),k=$(""),w=$(!1),v=$("0"),r=$([]),C=$(!1),x=$(""),g=$("");function u(){var A;const b=localStorage.getItem("redis_profiles");t.value=b?JSON.parse(b):[],t.value.length===0&&(t.value=[{id:"default_redis",name:"本地Redis",host:"127.0.0.1",port:6379,db:0,password:""}],c());const R=localStorage.getItem("redis_current_profile_id");n.value=R||((A=t.value[0])==null?void 0:A.id)||null}function c(){localStorage.setItem("redis_profiles",JSON.stringify(t.value))}function _(b){n.value=b,localStorage.setItem("redis_current_profile_id",b||"")}async function m(b){b.id||(b.id=`p_${Date.now()}`);const A=t.value.findIndex(Q=>Q.id===b.id);A>=0?t.value[A]={...t.value[A],...b}:t.value.push({...b}),c()}async function s(b){t.value=t.value.filter(R=>R.id!==b),n.value===b&&(n.value=null),c()}async function h(b){if(b||(b=n.value),!!b){a.value=!0;try{const R=t.value.find(O=>O.id===b);if(!R)return;const{host:A,port:Q,db:W,password:X}=R,S=await Ve({host:A,port:Q,db:W,password:X});(S==null?void 0:S.code)===0&&(Te({host:A,port:Q,db:W,password:X}),o.value=!0,n.value=b,p.value=p.value||"*",k.value="",v.value="0",r.value=[],await K())}finally{a.value=!1}}}async function i(){o.value=!1}async function L(b){(b==null?void 0:b.pattern)!==void 0&&(p.value=b.pattern),(b==null?void 0:b.type)!==void 0&&(k.value=b.type),v.value="0",r.value=[],await K()}async function D(){p.value="*",k.value="",await L({})}async function K(){if(o.value){w.value=!0;try{const b=await Se({cursor:v.value,match:p.value||void 0,count:100,type:k.value||void 0});v.value=b.data.cursor;const R=b.data.keys;r.value=r.value.concat(R),C.value=v.value!=="0"}finally{w.value=!1}}}function M(b){x.value=(b==null?void 0:b.key)||"",g.value=(b==null?void 0:b.type)||""}async function P(b){await Pe(b),r.value=r.value.filter(R=>R.key!==b)}async function q(b,R){await Le(b,R),await G()}async function I(b,R){await Me(b,R),await G()}async function U(b){await De(b),await G()}async function G(){x.value}return{profiles:t,currentProfileId:n,connecting:a,connected:o,pattern:p,typeFilter:k,scanning:w,cursor:v,keys:r,hasMore:C,selectedKey:x,selectedType:g,init:u,saveProfile:m,deleteProfile:s,selectProfile:_,connect:h,disconnect:i,search:L,resetSearch:D,loadMore:K,selectKey:M,deleteKey:P,renameKey:q,expireKey:I,persistKey:U,refreshSelected:G}});const lt={class:"conn"},nt={class:"conn-head"},at={class:"conn-list"},ot=["onClick"],st={class:"conn-item-main"},it={class:"title"},dt={class:"ops"},ut={__name:"ConnectionList",props:{profiles:{type:Array,default:()=>[]},currentProfileId:{type:String,default:""},connecting:{type:Boolean,default:!1},connected:{type:Boolean,default:!1}},emits:["save","delete","connect","disconnect","select"],setup(t,{emit:n}){const a=n,o=$(!1),p=$({id:"",name:"",host:"127.0.0.1",port:6379,db:0,password:""});function k(v){v?p.value={...v}:p.value={id:"",name:"",host:"127.0.0.1",port:6379,db:0,password:""},o.value=!0}function w(){!p.value.name||!p.value.host||!p.value.port||(a("save",{...p.value}),o.value=!1)}return(v,r)=>{const C=f("el-button"),x=f("el-popconfirm"),g=f("el-scrollbar"),u=f("el-input"),c=f("el-form-item"),_=f("el-form"),m=f("el-dialog");return z(),F("div",lt,[y("div",nt,[r[10]||(r[10]=y("span",null,"连接管理",-1)),e(C,{type:"primary",size:"small",onClick:r[0]||(r[0]=s=>k())},{default:l(()=>[...r[9]||(r[9]=[d("新建",-1)])]),_:1})]),e(g,{height:"calc(100% - 40px)"},{default:l(()=>[y("div",at,[(z(!0),F(ye,null,ve(t.profiles,s=>(z(),F("div",{key:s.id,class:ae(["conn-item",{active:s.id===t.currentProfileId}]),onClick:h=>a("select",s.id)},[y("div",st,[y("div",it,[d(N(s.name)+" ",1),y("small",null,N(s.host)+":"+N(s.port),1)]),y("div",dt,[t.connected&&s.id===t.currentProfileId?(z(),B(C,{key:0,size:"small",onClick:r[1]||(r[1]=ee(h=>a("disconnect"),["stop"])),loading:t.connecting},{default:l(()=>[...r[11]||(r[11]=[d("断开",-1)])]),_:1},8,["loading"])):(z(),B(C,{key:1,size:"small",type:"success",onClick:ee(h=>a("connect",s.id),["stop"]),loading:t.connecting},{default:l(()=>[...r[12]||(r[12]=[d("连接",-1)])]),_:1},8,["onClick","loading"])),e(C,{size:"small",onClick:ee(h=>k(s),["stop"])},{default:l(()=>[...r[13]||(r[13]=[d("编辑",-1)])]),_:1},8,["onClick"]),e(x,{title:"删除该连接？",onConfirm:h=>a("delete",s.id)},{reference:l(()=>[e(C,{size:"small",type:"danger"},{default:l(()=>[...r[14]||(r[14]=[d("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])])])],10,ot))),128))])]),_:1}),e(m,{modelValue:o.value,"onUpdate:modelValue":r[8]||(r[8]=s=>o.value=s),title:"连接配置",width:"520"},{footer:l(()=>[e(C,{onClick:r[7]||(r[7]=s=>o.value=!1)},{default:l(()=>[...r[15]||(r[15]=[d("取消",-1)])]),_:1}),e(C,{type:"primary",onClick:w},{default:l(()=>[...r[16]||(r[16]=[d("保存",-1)])]),_:1})]),default:l(()=>[e(_,{model:p.value,"label-width":"90px"},{default:l(()=>[e(c,{label:"名称"},{default:l(()=>[e(u,{modelValue:p.value.name,"onUpdate:modelValue":r[2]||(r[2]=s=>p.value.name=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"Host"},{default:l(()=>[e(u,{modelValue:p.value.host,"onUpdate:modelValue":r[3]||(r[3]=s=>p.value.host=s),placeholder:"127.0.0.1"},null,8,["modelValue"])]),_:1}),e(c,{label:"Port"},{default:l(()=>[e(u,{modelValue:p.value.port,"onUpdate:modelValue":r[4]||(r[4]=s=>p.value.port=s),modelModifiers:{number:!0},placeholder:"6379"},null,8,["modelValue"])]),_:1}),e(c,{label:"DB"},{default:l(()=>[e(u,{modelValue:p.value.db,"onUpdate:modelValue":r[5]||(r[5]=s=>p.value.db=s),modelModifiers:{number:!0},placeholder:"0"},null,8,["modelValue"])]),_:1}),e(c,{label:"密码"},{default:l(()=>[e(u,{modelValue:p.value.password,"onUpdate:modelValue":r[6]||(r[6]=s=>p.value.password=s),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},rt=j(ut,[["__scopeId","data-v-506e6bdc"]]);const ct={class:"bar"},pt={__name:"KeySearchBar",props:{pattern:String,typeFilter:String,loading:Boolean},emits:["search","reset","refresh"],setup(t,{emit:n}){const a=t,o=n,p=ge({pattern:a.pattern||"*",type:a.typeFilter||""});be(()=>{p.pattern=a.pattern,p.type=a.typeFilter});function k(){o("search",{pattern:p.pattern,type:p.type})}return(w,v)=>{const r=f("el-input"),C=f("el-option"),x=f("el-select"),g=f("el-button");return z(),F("div",ct,[e(r,{modelValue:p.pattern,"onUpdate:modelValue":v[0]||(v[0]=u=>p.pattern=u),placeholder:"模式，如 user:*",style:{width:"320px"}},null,8,["modelValue"]),e(x,{modelValue:p.type,"onUpdate:modelValue":v[1]||(v[1]=u=>p.type=u),placeholder:"类型",clearable:"",style:{width:"160px","margin-left":"8px"}},{default:l(()=>[e(C,{label:"全部",value:""}),e(C,{label:"string",value:"string"}),e(C,{label:"hash",value:"hash"}),e(C,{label:"list",value:"list"}),e(C,{label:"set",value:"set"}),e(C,{label:"zset",value:"zset"})]),_:1},8,["modelValue"]),e(g,{type:"primary",loading:t.loading,style:{"margin-left":"8px"},onClick:k},{default:l(()=>[...v[4]||(v[4]=[d("搜索",-1)])]),_:1},8,["loading"]),e(g,{loading:t.loading,onClick:v[2]||(v[2]=u=>o("refresh"))},{default:l(()=>[...v[5]||(v[5]=[d("刷新",-1)])]),_:1},8,["loading"]),e(g,{onClick:v[3]||(v[3]=u=>o("reset"))},{default:l(()=>[...v[6]||(v[6]=[d("重置",-1)])]),_:1})])}}},mt=j(pt,[["__scopeId","data-v-5f628447"]]);const ft={class:"key-tree"},_t={class:"node-label"},yt=["title"],vt={key:3,class:"ttl"},gt={class:"more"},bt={__name:"KeyTree",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},delimiter:{type:String,default:":"}},emits:["select","loadMore"],setup(t,{emit:n}){const a=t,o=n,p={label:"label",children:"children"};function k(x,g){const u={};for(const _ of x){const m=String(_.key).split(g);let s=u;for(let h=0;h<m.length;h++){const i=m[h];s.children=s.children||{},s.children[i]||(s.children[i]={__meta:null,children:{}}),s=s.children[i],h===m.length-1&&(s.__meta=_)}}function c(_,m=[]){const s=[];for(const h of Object.keys(_)){const i=_[h],L=Object.keys(i.children||{}).length>0&&!i.__meta,K={id:[...m,h].join(":"),label:h,isFolder:L,children:[]};i.__meta&&(K.isFolder=!1,K.type=i.__meta.type,K.ttl=i.__meta.ttl,K.fullKey=i.__meta.key);const M=c(i.children||{},[...m,h]);M.length&&(K.children=M),s.push(K)}return s.sort((h,i)=>h.isFolder===i.isFolder?h.label.localeCompare(i.label):h.isFolder?-1:1),s}return c(u.children||{})}const w=E(()=>k(a.items||[],a.delimiter)),v=$();function r(x){!x.isFolder&&x.fullKey&&o("select",{key:x.fullKey,type:x.type,ttl:x.ttl})}function C(){var u;const x=(u=v.value)==null?void 0:u.wrapRef;if(!x)return;x.scrollTop+x.clientHeight>=x.scrollHeight-20&&!a.loading&&a.hasMore&&o("loadMore")}return(x,g)=>{const u=f("el-icon"),c=f("el-tag"),_=f("el-tree"),m=f("el-scrollbar"),s=f("el-button"),h=f("el-text");return z(),F("div",ft,[e(m,{height:"100%",ref_key:"scrollbarRef",ref:v,onScroll:C},{default:l(()=>[e(_,{data:w.value,props:p,"node-key":"id","highlight-current":"","default-expanded-keys":[],"expand-on-click-node":!0,onNodeClick:r},{default:l(({data:i})=>[y("span",_t,[i.isFolder?(z(),B(u,{key:0,style:{"margin-right":"6px"}},{default:l(()=>[e(te(ke))]),_:1})):(z(),B(u,{key:1,style:{"margin-right":"6px"}},{default:l(()=>[e(te(he))]),_:1})),y("span",{class:"text",title:i.fullKey||i.label},N(i.label),9,yt),!i.isFolder&&i.type?(z(),B(c,{key:2,size:"small",style:{"margin-left":"8px"}},{default:l(()=>[d(N(i.type),1)]),_:2},1024)):Z("",!0),!i.isFolder&&i.ttl!==void 0?(z(),F("span",vt,"TTL: "+N(i.ttl),1)):Z("",!0)])]),_:1},8,["data"])]),_:1},512),y("div",gt,[t.hasMore?(z(),B(s,{key:0,loading:t.loading,onClick:g[0]||(g[0]=i=>x.$emit("loadMore"))},{default:l(()=>[...g[1]||(g[1]=[d("加载更多",-1)])]),_:1},8,["loading"])):(z(),B(h,{key:1,type:"info"},{default:l(()=>[...g[2]||(g[2]=[d("没有更多了",-1)])]),_:1}))])])}}},kt=j(bt,[["__scopeId","data-v-e7f24a28"]]);const ht={class:"header"},wt={class:"metadata-content"},xt={class:"metadata-grid"},Ct={class:"metadata-item"},$t={class:"value key-name"},zt={class:"metadata-item"},Nt={class:"value"},Tt={class:"metadata-item"},Vt={class:"value"},St={key:0,class:"no-expiry"},Kt={key:1,class:"expired"},Mt={key:2,class:"ttl-value"},Dt={key:0,class:"metadata-item"},Lt={class:"value"},Pt={key:1,class:"metadata-item"},Rt={class:"value"},Bt={key:2,class:"metadata-item"},Ft={class:"value"},It={key:3,class:"metadata-item"},Ut={class:"value"},Et={key:4,class:"metadata-item"},At={class:"value"},Ot={class:"metadata-item"},Ht={class:"value"},jt={__name:"KeyMetadata",props:{keyName:{type:String,required:!0}},setup(t){const n=t,a=$(!1),o=$({}),p=g=>({string:"primary",list:"success",set:"warning",zset:"danger",hash:"info",none:"info"})[g]||"info",k=g=>{if(g===-1)return"永不过期";if(g===-2||g<=0)return"已过期";const u=Math.floor(g/86400),c=Math.floor(g%86400/3600),_=Math.floor(g%3600/60),m=g%60,s=[];return u>0&&s.push(`${u}天`),c>0&&s.push(`${c}小时`),_>0&&s.push(`${_}分钟`),m>0&&s.push(`${m}秒`),s.join(" ")||"即将过期"},w=g=>{if(g===0)return"0 B";const u=1024,c=["B","KB","MB","GB","TB"],_=Math.floor(Math.log(g)/Math.log(u));return parseFloat((g/Math.pow(u,_)).toFixed(2))+" "+c[_]},v=g=>g.toLocaleString(),r=g=>g<60?`${g}秒`:g<3600?`${Math.floor(g/60)}分钟`:g<86400?`${Math.floor(g/3600)}小时`:`${Math.floor(g/86400)}天`,C=async()=>{if(n.keyName){a.value=!0;try{o.value=await Ke(n.keyName)}catch(g){console.error("获取键元数据失败:",g),o.value={}}finally{a.value=!1}}},x=()=>{C()};return we(()=>n.keyName,()=>{C()},{immediate:!0}),J(()=>{C()}),(g,u)=>{const c=f("el-icon"),_=f("el-button"),m=f("el-tag"),s=f("el-card"),h=xe("loading");return z(),B(s,{shadow:"never",class:"metadata-card"},{header:l(()=>[y("div",ht,[u[1]||(u[1]=y("span",null,"键信息",-1)),e(_,{size:"small",onClick:x,loading:a.value},{default:l(()=>[e(c,null,{default:l(()=>[e(te(Ce))]),_:1}),u[0]||(u[0]=d(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:l(()=>[oe((z(),F("div",wt,[y("div",xt,[y("div",Ct,[u[2]||(u[2]=y("div",{class:"label"},"键名",-1)),y("div",$t,N(t.keyName),1)]),y("div",zt,[u[3]||(u[3]=y("div",{class:"label"},"类型",-1)),y("div",Nt,[e(m,{type:p(o.value.type),size:"small"},{default:l(()=>[d(N(o.value.type||"unknown"),1)]),_:1},8,["type"])])]),y("div",Tt,[u[4]||(u[4]=y("div",{class:"label"},"TTL",-1)),y("div",Vt,[o.value.ttl===-1?(z(),F("span",St,"永不过期")):o.value.ttl===-2?(z(),F("span",Kt,"已过期")):(z(),F("span",Mt,[d(N(k(o.value.ttl))+" ",1),o.value.ttl>0?(z(),B(m,{key:0,size:"small",type:"warning"},{default:l(()=>[d(N(o.value.ttl)+"秒 ",1)]),_:1})):Z("",!0)]))])]),o.value.length!==void 0?(z(),F("div",Dt,[u[5]||(u[5]=y("div",{class:"label"},"长度",-1)),y("div",Lt,N(v(o.value.length)),1)])):Z("",!0),o.value.memoryUsage>0?(z(),F("div",Pt,[u[6]||(u[6]=y("div",{class:"label"},"内存使用",-1)),y("div",Rt,N(w(o.value.memoryUsage)),1)])):Z("",!0),o.value.encoding?(z(),F("div",Bt,[u[7]||(u[7]=y("div",{class:"label"},"编码",-1)),y("div",Ft,[e(m,{size:"small",type:"info"},{default:l(()=>[d(N(o.value.encoding),1)]),_:1})])])):Z("",!0),o.value.refCount!==void 0?(z(),F("div",It,[u[8]||(u[8]=y("div",{class:"label"},"引用计数",-1)),y("div",Ut,N(o.value.refCount),1)])):Z("",!0),o.value.idleTime!==void 0?(z(),F("div",Et,[u[9]||(u[9]=y("div",{class:"label"},"空闲时间",-1)),y("div",At,N(r(o.value.idleTime)),1)])):Z("",!0),y("div",Ot,[u[10]||(u[10]=y("div",{class:"label"},"存在状态",-1)),y("div",Ht,[e(m,{type:o.value.exists?"success":"danger",size:"small"},{default:l(()=>[d(N(o.value.exists?"存在":"不存在"),1)]),_:1},8,["type"])])])])])),[[h,a.value]])]),_:1})}}},qt=j(jt,[["__scopeId","data-v-12cd3069"]]);const Gt={class:"head"},Zt={class:"title"},Jt={class:"ops"},Qt={style:{"margin-top":"8px","text-align":"right"}},Wt={__name:"KeyDetailString",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh","delete"],setup(t,{emit:n}){const a=t,o=n,p=$(""),k=$(!1),w=$(!1);async function v(){p.value=await Re(a.keyName)||""}async function r(){w.value=!0;try{await Be(a.keyName,p.value)}finally{w.value=!1,o("refresh")}}function C(){H.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:u})=>o("rename",{key:a.keyName,newKey:u})).catch(()=>{})}function x(){H.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:u})=>o("expire",{key:a.keyName,ttl:Number(u)})).catch(()=>{})}function g(){k.value=!k.value}return J(v),(u,c)=>{const _=f("el-tag"),m=f("el-button"),s=f("el-input"),h=f("el-popconfirm"),i=f("el-card");return z(),B(i,{shadow:"never",class:"detail"},{header:l(()=>[y("div",Gt,[y("div",Zt,[d(N(t.keyName)+" ",1),e(_,{size:"small"},{default:l(()=>[...c[3]||(c[3]=[d("string",-1)])]),_:1})]),y("div",Jt,[e(m,{size:"small",onClick:g,type:k.value?"warning":"default"},{default:l(()=>[d(N(k.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(m,{size:"small",onClick:C},{default:l(()=>[...c[4]||(c[4]=[d("重命名",-1)])]),_:1}),e(m,{size:"small",onClick:x},{default:l(()=>[...c[5]||(c[5]=[d("设置TTL",-1)])]),_:1}),e(m,{size:"small",onClick:c[0]||(c[0]=L=>o("persist",t.keyName))},{default:l(()=>[...c[6]||(c[6]=[d("移除TTL",-1)])]),_:1}),e(m,{size:"small",type:"primary",onClick:r,disabled:!k.value,loading:w.value},{default:l(()=>[...c[7]||(c[7]=[d("保存",-1)])]),_:1},8,["disabled","loading"])])])]),default:l(()=>[e(s,{modelValue:p.value,"onUpdate:modelValue":c[1]||(c[1]=L=>p.value=L),type:"textarea",rows:20,placeholder:"值...",disabled:!k.value},null,8,["modelValue","disabled"]),y("div",Qt,[e(h,{title:"删除该键？",onConfirm:c[2]||(c[2]=L=>o("delete",t.keyName))},{reference:l(()=>[e(m,{size:"small",type:"danger",disabled:!k.value},{default:l(()=>[...c[8]||(c[8]=[d("删除键",-1)])]),_:1},8,["disabled"])]),_:1})])]),_:1})}}},Xt=j(Wt,[["__scopeId","data-v-db0f7a8e"]]);const Yt={class:"head"},el={class:"title"},tl={class:"ops"},ll={__name:"KeyDetailHash",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,o=n,p=$([]),k=$(!1);async function w(){const c=await Fe(a.keyName,0,200);p.value=Object.entries(c).map(([_,m])=>({field:_,value:m}))}function v(){p.value.unshift({field:"",value:""})}async function r(c){await Ie(a.keyName,c.field,c.value),o("refresh")}async function C(c){await Ue(a.keyName,c.field),p.value=p.value.filter(_=>_.field!==c.field),o("refresh")}function x(){H.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:c})=>o("rename",{key:a.keyName,newKey:c})).catch(()=>{})}function g(){H.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:c})=>o("expire",{key:a.keyName,ttl:Number(c)})).catch(()=>{})}function u(){k.value=!k.value}return J(w),(c,_)=>{const m=f("el-tag"),s=f("el-button"),h=f("el-input"),i=f("el-table-column"),L=f("el-popconfirm"),D=f("el-table"),K=f("el-card");return z(),B(K,{shadow:"never",class:"detail"},{header:l(()=>[y("div",Yt,[y("div",el,[d(N(t.keyName)+" ",1),e(m,{size:"small"},{default:l(()=>[..._[1]||(_[1]=[d("hash",-1)])]),_:1})]),y("div",tl,[e(s,{size:"small",onClick:u,type:k.value?"warning":"default"},{default:l(()=>[d(N(k.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(s,{size:"small",onClick:x},{default:l(()=>[..._[2]||(_[2]=[d("重命名",-1)])]),_:1}),e(s,{size:"small",onClick:g},{default:l(()=>[..._[3]||(_[3]=[d("设置TTL",-1)])]),_:1}),e(s,{size:"small",onClick:_[0]||(_[0]=M=>o("persist",t.keyName))},{default:l(()=>[..._[4]||(_[4]=[d("移除TTL",-1)])]),_:1}),e(s,{size:"small",type:"primary",onClick:v,disabled:!k.value},{default:l(()=>[..._[5]||(_[5]=[d("新增字段",-1)])]),_:1},8,["disabled"])])])]),default:l(()=>[e(D,{data:p.value,height:"calc(100% - 10px)"},{default:l(()=>[e(i,{prop:"field",label:"Field","min-width":"200"},{default:l(({row:M})=>[e(h,{modelValue:M.field,"onUpdate:modelValue":P=>M.field=P,placeholder:"字段名",disabled:!k.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(i,{prop:"value",label:"Value","min-width":"300"},{default:l(({row:M})=>[e(h,{modelValue:M.value,"onUpdate:modelValue":P=>M.value=P,disabled:!k.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(i,{label:"操作",width:"200"},{default:l(({row:M})=>[e(s,{size:"small",type:"primary",onClick:P=>r(M),disabled:!k.value},{default:l(()=>[..._[6]||(_[6]=[d("保存",-1)])]),_:1},8,["onClick","disabled"]),e(L,{title:"删除该字段？",onConfirm:P=>C(M)},{reference:l(()=>[e(s,{size:"small",type:"danger",disabled:!k.value},{default:l(()=>[..._[7]||(_[7]=[d("删除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})}}},nl=j(ll,[["__scopeId","data-v-0687eacc"]]);const al={class:"head"},ol={class:"title"},sl={class:"ops"},il={class:"bar"},dl={style:{display:"flex",gap:"8px","align-items":"center"}},ul={__name:"KeyDetailList",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,o=n,p=$([]),k=$(""),w=$(!1);async function v(){p.value=await Ee(a.keyName,0,100)}async function r(){await Ae(a.keyName,k.value),k.value="",await v(),o("refresh")}async function C(){await Oe(a.keyName,k.value),k.value="",await v(),o("refresh")}async function x(){await He(a.keyName),await v(),o("refresh")}async function g(){await je(a.keyName),await v(),o("refresh")}async function u(h,i){await qe(a.keyName,h,i),await v(),o("refresh")}async function c(h){await Ge(a.keyName,h),await v(),o("refresh")}function _(){H.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:h})=>o("rename",{key:a.keyName,newKey:h})).catch(()=>{})}function m(){H.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:h})=>o("expire",{key:a.keyName,ttl:Number(h)})).catch(()=>{})}J(v);function s(){w.value=!w.value}return(h,i)=>{const L=f("el-tag"),D=f("el-button"),K=f("el-input"),M=f("el-table-column"),P=f("el-popconfirm"),q=f("el-table"),I=f("el-card");return z(),B(I,{shadow:"never",class:"detail"},{header:l(()=>[y("div",al,[y("div",ol,[d(N(t.keyName)+" ",1),e(L,{size:"small"},{default:l(()=>[...i[2]||(i[2]=[d("list",-1)])]),_:1})]),y("div",sl,[e(D,{size:"small",onClick:s,type:w.value?"warning":"default"},{default:l(()=>[d(N(w.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(D,{size:"small",onClick:_},{default:l(()=>[...i[3]||(i[3]=[d("重命名",-1)])]),_:1}),e(D,{size:"small",onClick:m},{default:l(()=>[...i[4]||(i[4]=[d("设置TTL",-1)])]),_:1}),e(D,{size:"small",onClick:i[0]||(i[0]=U=>o("persist",t.keyName))},{default:l(()=>[...i[5]||(i[5]=[d("移除TTL",-1)])]),_:1})])])]),default:l(()=>[y("div",il,[e(K,{modelValue:k.value,"onUpdate:modelValue":i[1]||(i[1]=U=>k.value=U),style:{width:"60%"},placeholder:"值",disabled:!w.value},null,8,["modelValue","disabled"]),e(D,{size:"small",type:"primary",onClick:r,disabled:!w.value},{default:l(()=>[...i[6]||(i[6]=[d("LPUSH",-1)])]),_:1},8,["disabled"]),e(D,{size:"small",type:"primary",onClick:C,disabled:!w.value},{default:l(()=>[...i[7]||(i[7]=[d("RPUSH",-1)])]),_:1},8,["disabled"]),e(D,{size:"small",onClick:x,disabled:!w.value},{default:l(()=>[...i[8]||(i[8]=[d("LPOP",-1)])]),_:1},8,["disabled"]),e(D,{size:"small",onClick:g,disabled:!w.value},{default:l(()=>[...i[9]||(i[9]=[d("RPOP",-1)])]),_:1},8,["disabled"])]),e(q,{data:p.value,height:"calc(100% - 80px)"},{default:l(()=>[e(M,{type:"index",width:"70"}),e(M,{prop:"value",label:"Value"},{default:l(({row:U,$index:G})=>[y("div",dl,[e(K,{modelValue:U.value,"onUpdate:modelValue":b=>U.value=b,disabled:!w.value},null,8,["modelValue","onUpdate:modelValue","disabled"]),e(D,{size:"small",type:"primary",onClick:b=>u(G,U.value),disabled:!w.value},{default:l(()=>[...i[10]||(i[10]=[d("保存",-1)])]),_:1},8,["onClick","disabled"]),e(P,{title:"删除该元素？",onConfirm:b=>c(U.value)},{reference:l(()=>[e(D,{size:"small",type:"danger",disabled:!w.value},{default:l(()=>[...i[11]||(i[11]=[d("删除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])])]),_:1})]),_:1},8,["data"])]),_:1})}}},rl=j(ul,[["__scopeId","data-v-a1b3d0c1"]]);const cl={class:"head"},pl={class:"title"},ml={class:"ops"},fl={class:"bar"},_l={__name:"KeyDetailSet",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,o=n,p=$([]),k=$(""),w=$(!1),v=$("0");async function r(){const _=await Ze(a.keyName,v.value,void 0,200);v.value=_.cursor,p.value=_.members.map(m=>({member:m}))}async function C(){await Je(a.keyName,k.value),k.value="",await r(),o("refresh")}async function x(_){await Qe(a.keyName,_.member),await r(),o("refresh")}function g(){H.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:_})=>o("rename",{key:a.keyName,newKey:_})).catch(()=>{})}function u(){H.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:_})=>o("expire",{key:a.keyName,ttl:Number(_)})).catch(()=>{})}J(r);function c(){w.value=!w.value}return(_,m)=>{const s=f("el-tag"),h=f("el-button"),i=f("el-input"),L=f("el-table-column"),D=f("el-popconfirm"),K=f("el-table"),M=f("el-card");return z(),B(M,{shadow:"never",class:"detail"},{header:l(()=>[y("div",cl,[y("div",pl,[d(N(t.keyName)+" ",1),e(s,{size:"small"},{default:l(()=>[...m[2]||(m[2]=[d("set",-1)])]),_:1})]),y("div",ml,[e(h,{size:"small",onClick:c,type:w.value?"warning":"default"},{default:l(()=>[d(N(w.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(h,{size:"small",onClick:g},{default:l(()=>[...m[3]||(m[3]=[d("重命名",-1)])]),_:1}),e(h,{size:"small",onClick:u},{default:l(()=>[...m[4]||(m[4]=[d("设置TTL",-1)])]),_:1}),e(h,{size:"small",onClick:m[0]||(m[0]=P=>o("persist",t.keyName))},{default:l(()=>[...m[5]||(m[5]=[d("移除TTL",-1)])]),_:1})])])]),default:l(()=>[y("div",fl,[e(i,{modelValue:k.value,"onUpdate:modelValue":m[1]||(m[1]=P=>k.value=P),style:{width:"60%"},placeholder:"成员",disabled:!w.value},null,8,["modelValue","disabled"]),e(h,{size:"small",type:"primary",onClick:C,disabled:!w.value},{default:l(()=>[...m[6]||(m[6]=[d("SADD",-1)])]),_:1},8,["disabled"])]),e(K,{data:p.value,height:"calc(100% - 80px)"},{default:l(()=>[e(L,{prop:"member",label:"Member"}),e(L,{label:"操作",width:"120"},{default:l(({row:P})=>[e(D,{title:"移除该成员？",onConfirm:q=>x(P)},{reference:l(()=>[e(h,{size:"small",type:"danger",disabled:!w.value},{default:l(()=>[...m[7]||(m[7]=[d("移除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})}}},yl=j(_l,[["__scopeId","data-v-554642d9"]]);const vl={class:"head"},gl={class:"title"},bl={class:"ops"},kl={class:"bar"},hl={__name:"KeyDetailZSet",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,o=n,p=$([]),k=$(""),w=$(0),v=$(!1);async function r(){p.value=await We(a.keyName,0,200)}async function C(){await Xe(a.keyName,k.value,Number(w.value)),k.value="",w.value=0,await r(),o("refresh")}async function x(m){await Ye(a.keyName,m.member),await r(),o("refresh")}async function g(m){await et(a.keyName,m.member,.1),await r(),o("refresh")}function u(){H.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:m})=>o("rename",{key:a.keyName,newKey:m})).catch(()=>{})}function c(){H.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:m})=>o("expire",{key:a.keyName,ttl:Number(m)})).catch(()=>{})}J(r);function _(){v.value=!v.value}return(m,s)=>{const h=f("el-tag"),i=f("el-button"),L=f("el-input-number"),D=f("el-input"),K=f("el-table-column"),M=f("el-popconfirm"),P=f("el-table"),q=f("el-card");return z(),B(q,{shadow:"never",class:"detail"},{header:l(()=>[y("div",vl,[y("div",gl,[d(N(t.keyName)+" ",1),e(h,{size:"small"},{default:l(()=>[...s[3]||(s[3]=[d("zset",-1)])]),_:1})]),y("div",bl,[e(i,{size:"small",onClick:_,type:v.value?"warning":"default"},{default:l(()=>[d(N(v.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(i,{size:"small",onClick:u},{default:l(()=>[...s[4]||(s[4]=[d("重命名",-1)])]),_:1}),e(i,{size:"small",onClick:c},{default:l(()=>[...s[5]||(s[5]=[d("设置TTL",-1)])]),_:1}),e(i,{size:"small",onClick:s[0]||(s[0]=I=>o("persist",t.keyName))},{default:l(()=>[...s[6]||(s[6]=[d("移除TTL",-1)])]),_:1})])])]),default:l(()=>[y("div",kl,[e(L,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=I=>w.value=I),min:-999999,max:999999,disabled:!v.value},null,8,["modelValue","disabled"]),e(D,{modelValue:k.value,"onUpdate:modelValue":s[2]||(s[2]=I=>k.value=I),style:{width:"60%"},placeholder:"成员",disabled:!v.value},null,8,["modelValue","disabled"]),e(i,{size:"small",type:"primary",onClick:C,disabled:!v.value},{default:l(()=>[...s[7]||(s[7]=[d("ZADD",-1)])]),_:1},8,["disabled"])]),e(P,{data:p.value,height:"calc(100% - 80px)"},{default:l(()=>[e(K,{prop:"score",label:"Score",width:"100"}),e(K,{prop:"member",label:"Member"}),e(K,{label:"操作",width:"160"},{default:l(({row:I})=>[e(i,{size:"small",onClick:U=>g(I),disabled:!v.value},{default:l(()=>[...s[8]||(s[8]=[d("+0.1",-1)])]),_:1},8,["onClick","disabled"]),e(M,{title:"移除该成员？",onConfirm:U=>x(I)},{reference:l(()=>[e(i,{size:"small",type:"danger",disabled:!v.value},{default:l(()=>[...s[9]||(s[9]=[d("移除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})}}},wl=j(hl,[["__scopeId","data-v-9dcfb503"]]);const xl={class:"sidebar-content"},Cl={class:"header-left"},$l={class:"header-right"},zl={key:0,style:{height:"100%",display:"flex","flex-direction":"column"}},Nl={style:{flex:"1",overflow:"hidden"}},Tl={__name:"RedisExplorer",setup(t){const n=tt(),a=$e(),o=$(!1),p=E(()=>n.profiles),k=E(()=>n.currentProfileId),w=E(()=>n.connecting),v=E(()=>n.connected),r=E(()=>n.pattern),C=E(()=>n.typeFilter),x=E(()=>n.scanning),g=E(()=>n.keys),u=E(()=>n.hasMore),c=E(()=>n.selectedKey),_=E(()=>n.selectedType),m=E(()=>{switch(_.value){case"string":return Xt;case"hash":return nl;case"list":return rl;case"set":return yl;case"zset":return wl;default:return null}});function s(S){n.saveProfile(S)}function h(S){n.deleteProfile(S)}function i(S){n.connect(S)}function L(){n.disconnect()}function D(S){n.selectProfile(S)}function K(S){n.search(S)}function M(){n.search({pattern:r.value,type:C.value})}function P(){n.resetSearch()}function q(){n.loadMore()}function I(S){n.selectKey(S)}function U(S){n.deleteKey(S)}function G({key:S,newKey:O}){n.renameKey(S,O)}function b({key:S,ttl:O}){n.expireKey(S,O)}function R(S){n.persistKey(S)}function A(){n.refreshSelected()}function Q(){o.value=!o.value}function W(){a.push({name:"Dashboard"})}function X(){a.push({name:"Dashboard",query:{openMqtt:1}})}return J(()=>{n.init()}),(S,O)=>{const ie=f("el-aside"),Y=f("el-button"),de=f("el-header"),le=f("el-col"),ue=f("el-empty"),re=f("el-row"),ce=f("el-main"),ne=f("el-container");return z(),B(ne,{style:{height:"100%"}},{default:l(()=>[e(ie,{width:o.value?"0px":"320px",class:ae(["redis-aside",{collapsed:o.value}])},{default:l(()=>[oe(y("div",xl,[e(rt,{profiles:p.value,currentProfileId:k.value,connecting:w.value,connected:v.value,onSave:s,onDelete:h,onConnect:i,onDisconnect:L,onSelect:D},null,8,["profiles","currentProfileId","connecting","connected"])],512),[[ze,!o.value]])]),_:1},8,["width","class"]),e(ne,null,{default:l(()=>[e(de,{class:"redis-header"},{default:l(()=>[y("div",Cl,[e(Y,{icon:o.value?"Expand":"Fold",onClick:Q,class:"collapse-btn",circle:"",size:"small"},null,8,["icon"]),e(mt,{pattern:r.value,typeFilter:C.value,loading:x.value,onSearch:K,onRefresh:M,onReset:P},null,8,["pattern","typeFilter","loading"])]),y("div",$l,[e(Y,{onClick:W},{default:l(()=>[...O[0]||(O[0]=[d("返回仪表盘",-1)])]),_:1}),e(Y,{type:"primary",onClick:X},{default:l(()=>[...O[1]||(O[1]=[d("仪表盘打开MQTT",-1)])]),_:1})])]),_:1}),e(ce,{class:"redis-main"},{default:l(()=>[e(re,{gutter:12,style:{height:"100%"}},{default:l(()=>[e(le,{span:6,style:{height:"100%"}},{default:l(()=>[e(kt,{items:g.value,hasMore:u.value,loading:x.value,onLoadMore:q,onSelect:I},null,8,["items","hasMore","loading"])]),_:1}),e(le,{span:18,style:{height:"100%"}},{default:l(()=>[c.value?(z(),F("div",zl,[e(qt,{keyName:c.value},null,8,["keyName"]),y("div",Nl,[(z(),B(Ne(m.value),{key:c.value+":"+_.value,keyName:c.value,keyType:_.value,onRename:G,onExpire:b,onPersist:R,onDelete:U,onRefresh:A},null,40,["keyName","keyType"]))])])):(z(),B(ue,{key:1,description:"请选择一个键以查看详情"}))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},Sl=j(Tl,[["__scopeId","data-v-797737d3"]]);export{Sl as default};
