import{a as re,A as ce,T as pe,d as me,r as x,_ as H,b as c,o as D,c as Z,e as C,f as e,w as l,g as u,F as fe,h as _e,n as ne,t as E,i as R,j as X,k as ye,l as ve,m as F,u as te,p as ke,q as be,s as le,v as G,x as ge,y as he,z as we,B as xe}from"./index-80ce8aa8.js";const z=re.create({baseURL:ce,timeout:pe});let ae={host:"127.0.0.1",port:6379,db:0,password:""};function Ce(t){ae={host:t.host,port:t.port,db:t.db||0,password:t.password||""}}function T(t={}){return{...ae,...t}}async function Ve(t){const{data:n}=await z.post("/connect/test",t);return n}async function ze({cursor:t="0",match:n,count:a=100,type:s}){const{data:r}=await z.post("/scan",T({cursor:t,match:n,count:a,type:s}));return r}async function Ne(t,n){const{data:a}=await z.post("/expire",T({key:t,ttl:n}));return a.ok}async function Te(t){const{data:n}=await z.post("/persist",T({key:t}));return n.ok}async function Se(t,n){const{data:a}=await z.post("/rename",T({key:t,newKey:n}));return a.ok}async function $e(t){const{data:n}=await z.post("/del",T({key:t}));return n.ok}async function Ke(t){const{data:n}=await z.post("/get",T({key:t}));return n.value}async function De(t,n){const{data:a}=await z.post("/set",T({key:t,value:n}));return a.ok}async function Le(t,n=0,a=100){const{data:s}=await z.post("/hash/getall",T({key:t,offset:n,limit:a}));return s}async function Me(t,n,a){const{data:s}=await z.post("/hash/set",T({key:t,field:n,value:a}));return s.ok}async function Pe(t,n){const{data:a}=await z.post("/hash/del",T({key:t,field:n}));return a.ok}async function Ee(t,n=0,a=100){const{data:s}=await z.post("/list/range",T({key:t,start:n,stop:a}));return s.items}async function Re(t,n){const{data:a}=await z.post("/list/lpush",T({key:t,value:n}));return a.ok}async function Be(t,n){const{data:a}=await z.post("/list/rpush",T({key:t,value:n}));return a.ok}async function Ie(t){const{data:n}=await z.post("/list/lpop",T({key:t}));return n.item}async function Fe(t){const{data:n}=await z.post("/list/rpop",T({key:t}));return n.item}async function Ue(t,n,a){const{data:s}=await z.post("/list/set",T({key:t,index:n,value:a}));return s.ok}async function Ae(t,n){const{data:a}=await z.post("/list/lrem",T({key:t,value:n}));return a.ok}async function He(t,n="0",a,s=100){const{data:r}=await z.post("/set/scan",T({key:t,cursor:n,match:a,count:s}));return r}async function Oe(t,n){const{data:a}=await z.post("/set/sadd",T({key:t,member:n}));return a.ok}async function je(t,n){const{data:a}=await z.post("/set/srem",T({key:t,member:n}));return a.ok}async function qe(t,n=0,a=100){const{data:s}=await z.post("/zset/range",T({key:t,offset:n,limit:a}));return s.items}async function Ze(t,n,a){const{data:s}=await z.post("/zset/zadd",T({key:t,member:n,score:a}));return s.ok}async function Ge(t,n){const{data:a}=await z.post("/zset/zrem",T({key:t,member:n}));return a.ok}async function Je(t,n,a){const{data:s}=await z.post("/zset/zincrby",T({key:t,member:n,increment:a}));return s.score}const Qe=me("redis",()=>{const t=x([]),n=x(null),a=x(!1),s=x(!1),r=x("*"),k=x(""),b=x(!1),p=x("0"),d=x([]),w=x(!1),g=x(""),V=x("");function h(){var U;const y=localStorage.getItem("redis_profiles");t.value=y?JSON.parse(y):[];const P=localStorage.getItem("redis_current_profile_id");n.value=P||((U=t.value[0])==null?void 0:U.id)||null}function m(){localStorage.setItem("redis_profiles",JSON.stringify(t.value))}function f(y){n.value=y,localStorage.setItem("redis_current_profile_id",y||"")}async function v(y){y.id||(y.id=`p_${Date.now()}`);const U=t.value.findIndex(q=>q.id===y.id);U>=0?t.value[U]={...t.value[U],...y}:t.value.push({...y}),m()}async function _(y){t.value=t.value.filter(P=>P.id!==y),n.value===y&&(n.value=null),m()}async function i(y){if(y||(y=n.value),!!y){a.value=!0;try{const P=t.value.find(A=>A.id===y);if(!P)return;const{host:U,port:q,db:J,password:Q}=P,N=await Ve({host:U,port:q,db:J,password:Q});N!=null&&N.ok&&(Ce({host:U,port:q,db:J,password:Q}),s.value=!0,n.value=y,r.value=r.value||"*",k.value="",p.value="0",d.value=[],await S())}finally{a.value=!1}}}async function o(){s.value=!1}async function L(y){(y==null?void 0:y.pattern)!==void 0&&(r.value=y.pattern),(y==null?void 0:y.type)!==void 0&&(k.value=y.type),p.value="0",d.value=[],await S()}async function K(){r.value="*",k.value="",await L({})}async function S(){if(s.value){b.value=!0;try{const y=await ze({cursor:p.value,match:r.value||void 0,count:100,type:k.value||void 0});p.value=y.cursor;const P=y.keys;d.value=d.value.concat(P),w.value=p.value!=="0"}finally{b.value=!1}}}function $(y){g.value=(y==null?void 0:y.key)||"",V.value=(y==null?void 0:y.type)||""}async function M(y){await $e(y),d.value=d.value.filter(P=>P.key!==y)}async function O(y,P){await Se(y,P),await j()}async function B(y,P){await Ne(y,P),await j()}async function I(y){await Te(y),await j()}async function j(){g.value}return{profiles:t,currentProfileId:n,connecting:a,connected:s,pattern:r,typeFilter:k,scanning:b,cursor:p,keys:d,hasMore:w,selectedKey:g,selectedType:V,init:h,saveProfile:v,deleteProfile:_,selectProfile:f,connect:i,disconnect:o,search:L,resetSearch:K,loadMore:S,selectKey:$,deleteKey:M,renameKey:O,expireKey:B,persistKey:I,refreshSelected:j}});const We={class:"conn"},Xe={class:"conn-head"},Ye=["onClick"],et={class:"conn-item-main"},tt={class:"title"},lt={class:"ops"},nt={__name:"ConnectionList",props:{profiles:{type:Array,default:()=>[]},currentProfileId:{type:String,default:""},connecting:{type:Boolean,default:!1},connected:{type:Boolean,default:!1}},emits:["save","delete","connect","disconnect","select"],setup(t,{emit:n}){const a=n,s=x(!1),r=x({id:"",name:"",host:"127.0.0.1",port:6379,db:0,password:""});function k(p){p?r.value={...p}:r.value={id:"",name:"",host:"127.0.0.1",port:6379,db:0,password:""},s.value=!0}function b(){!r.value.name||!r.value.host||!r.value.port||(a("save",{...r.value}),s.value=!1)}return(p,d)=>{const w=c("el-button"),g=c("el-popconfirm"),V=c("el-list"),h=c("el-scrollbar"),m=c("el-input"),f=c("el-form-item"),v=c("el-form"),_=c("el-dialog");return D(),Z("div",We,[C("div",Xe,[d[10]||(d[10]=C("span",null,"连接管理",-1)),e(w,{type:"primary",size:"small",onClick:d[0]||(d[0]=i=>k())},{default:l(()=>[...d[9]||(d[9]=[u("新建",-1)])]),_:1})]),e(h,{height:"calc(100% - 40px)"},{default:l(()=>[e(V,{class:"conn-list"},{default:l(()=>[(D(!0),Z(fe,null,_e(t.profiles,i=>(D(),Z("div",{key:i.id,class:ne(["conn-item",{active:i.id===t.currentProfileId}]),onClick:o=>a("select",i.id)},[C("div",et,[C("div",tt,[u(E(i.name)+" ",1),C("small",null,E(i.host)+":"+E(i.port),1)]),C("div",lt,[t.connected&&i.id===t.currentProfileId?(D(),R(w,{key:0,size:"small",onClick:d[1]||(d[1]=X(o=>a("disconnect"),["stop"])),loading:t.connecting},{default:l(()=>[...d[11]||(d[11]=[u("断开",-1)])]),_:1},8,["loading"])):(D(),R(w,{key:1,size:"small",type:"success",onClick:X(o=>a("connect",i.id),["stop"]),loading:t.connecting},{default:l(()=>[...d[12]||(d[12]=[u("连接",-1)])]),_:1},8,["onClick","loading"])),e(w,{size:"small",onClick:X(o=>k(i),["stop"])},{default:l(()=>[...d[13]||(d[13]=[u("编辑",-1)])]),_:1},8,["onClick"]),e(g,{title:"删除该连接？",onConfirm:o=>a("delete",i.id)},{reference:l(()=>[e(w,{size:"small",type:"danger"},{default:l(()=>[...d[14]||(d[14]=[u("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])])])],10,Ye))),128))]),_:1})]),_:1}),e(_,{modelValue:s.value,"onUpdate:modelValue":d[8]||(d[8]=i=>s.value=i),title:"连接配置",width:"520"},{footer:l(()=>[e(w,{onClick:d[7]||(d[7]=i=>s.value=!1)},{default:l(()=>[...d[15]||(d[15]=[u("取消",-1)])]),_:1}),e(w,{type:"primary",onClick:b},{default:l(()=>[...d[16]||(d[16]=[u("保存",-1)])]),_:1})]),default:l(()=>[e(v,{model:r.value,"label-width":"90px"},{default:l(()=>[e(f,{label:"名称"},{default:l(()=>[e(m,{modelValue:r.value.name,"onUpdate:modelValue":d[2]||(d[2]=i=>r.value.name=i)},null,8,["modelValue"])]),_:1}),e(f,{label:"Host"},{default:l(()=>[e(m,{modelValue:r.value.host,"onUpdate:modelValue":d[3]||(d[3]=i=>r.value.host=i),placeholder:"127.0.0.1"},null,8,["modelValue"])]),_:1}),e(f,{label:"Port"},{default:l(()=>[e(m,{modelValue:r.value.port,"onUpdate:modelValue":d[4]||(d[4]=i=>r.value.port=i),modelModifiers:{number:!0},placeholder:"6379"},null,8,["modelValue"])]),_:1}),e(f,{label:"DB"},{default:l(()=>[e(m,{modelValue:r.value.db,"onUpdate:modelValue":d[5]||(d[5]=i=>r.value.db=i),modelModifiers:{number:!0},placeholder:"0"},null,8,["modelValue"])]),_:1}),e(f,{label:"密码"},{default:l(()=>[e(m,{modelValue:r.value.password,"onUpdate:modelValue":d[6]||(d[6]=i=>r.value.password=i),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},at=H(nt,[["__scopeId","data-v-bc8f8866"]]);const ot={class:"bar"},st={__name:"KeySearchBar",props:{pattern:String,typeFilter:String,loading:Boolean},emits:["search","reset","refresh"],setup(t,{emit:n}){const a=t,s=n,r=ye({pattern:a.pattern||"*",type:a.typeFilter||""});ve(()=>{r.pattern=a.pattern,r.type=a.typeFilter});function k(){s("search",{pattern:r.pattern,type:r.type})}return(b,p)=>{const d=c("el-input"),w=c("el-option"),g=c("el-select"),V=c("el-button");return D(),Z("div",ot,[e(d,{modelValue:r.pattern,"onUpdate:modelValue":p[0]||(p[0]=h=>r.pattern=h),placeholder:"模式，如 user:*",style:{width:"320px"}},null,8,["modelValue"]),e(g,{modelValue:r.type,"onUpdate:modelValue":p[1]||(p[1]=h=>r.type=h),placeholder:"类型",clearable:"",style:{width:"160px","margin-left":"8px"}},{default:l(()=>[e(w,{label:"全部",value:""}),e(w,{label:"string",value:"string"}),e(w,{label:"hash",value:"hash"}),e(w,{label:"list",value:"list"}),e(w,{label:"set",value:"set"}),e(w,{label:"zset",value:"zset"})]),_:1},8,["modelValue"]),e(V,{type:"primary",loading:t.loading,style:{"margin-left":"8px"},onClick:k},{default:l(()=>[...p[4]||(p[4]=[u("搜索",-1)])]),_:1},8,["loading"]),e(V,{loading:t.loading,onClick:p[2]||(p[2]=h=>s("refresh"))},{default:l(()=>[...p[5]||(p[5]=[u("刷新",-1)])]),_:1},8,["loading"]),e(V,{onClick:p[3]||(p[3]=h=>s("reset"))},{default:l(()=>[...p[6]||(p[6]=[u("重置",-1)])]),_:1})])}}},it=H(st,[["__scopeId","data-v-5f628447"]]);const dt={class:"key-tree"},ut={class:"node-label"},rt=["title"],ct={key:3,class:"ttl"},pt={class:"more"},mt={__name:"KeyTree",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},delimiter:{type:String,default:":"}},emits:["select","loadMore"],setup(t,{emit:n}){const a=t,s=n,r={label:"label",children:"children"};function k(g,V){const h={};for(const f of g){const v=String(f.key).split(V);let _=h;for(let i=0;i<v.length;i++){const o=v[i];_.children=_.children||{},_.children[o]||(_.children[o]={__meta:null,children:{}}),_=_.children[o],i===v.length-1&&(_.__meta=f)}}function m(f,v=[]){const _=[];for(const i of Object.keys(f)){const o=f[i],L=Object.keys(o.children||{}).length>0&&!o.__meta,S={id:[...v,i].join(":"),label:i,isFolder:L,children:[]};o.__meta&&(S.isFolder=!1,S.type=o.__meta.type,S.ttl=o.__meta.ttl,S.fullKey=o.__meta.key);const $=m(o.children||{},[...v,i]);$.length&&(S.children=$),_.push(S)}return _.sort((i,o)=>i.isFolder===o.isFolder?i.label.localeCompare(o.label):i.isFolder?-1:1),_}return m(h.children||{})}const b=F(()=>k(a.items||[],a.delimiter)),p=x();function d(g){!g.isFolder&&g.fullKey&&s("select",{key:g.fullKey,type:g.type,ttl:g.ttl})}function w(){var h;const g=(h=p.value)==null?void 0:h.wrapRef;if(!g)return;g.scrollTop+g.clientHeight>=g.scrollHeight-20&&!a.loading&&a.hasMore&&s("loadMore")}return(g,V)=>{const h=c("el-icon"),m=c("el-tag"),f=c("el-tree"),v=c("el-scrollbar"),_=c("el-button"),i=c("el-text");return D(),Z("div",dt,[e(v,{height:"100%",ref_key:"scrollbarRef",ref:p,onScroll:w},{default:l(()=>[e(f,{data:b.value,props:r,"node-key":"id","highlight-current":"","default-expanded-keys":[],"expand-on-click-node":!0,onNodeClick:d},{default:l(({data:o})=>[C("span",ut,[o.isFolder?(D(),R(h,{key:0,style:{"margin-right":"6px"}},{default:l(()=>[e(te(ke))]),_:1})):(D(),R(h,{key:1,style:{"margin-right":"6px"}},{default:l(()=>[e(te(be))]),_:1})),C("span",{class:"text",title:o.fullKey||o.label},E(o.label),9,rt),!o.isFolder&&o.type?(D(),R(m,{key:2,size:"small",style:{"margin-left":"8px"}},{default:l(()=>[u(E(o.type),1)]),_:2},1024)):le("",!0),!o.isFolder&&o.ttl!==void 0?(D(),Z("span",ct,"TTL: "+E(o.ttl),1)):le("",!0)])]),_:1},8,["data"])]),_:1},512),C("div",pt,[t.hasMore?(D(),R(_,{key:0,loading:t.loading,onClick:V[0]||(V[0]=o=>g.$emit("loadMore"))},{default:l(()=>[...V[1]||(V[1]=[u("加载更多",-1)])]),_:1},8,["loading"])):(D(),R(i,{key:1,type:"info"},{default:l(()=>[...V[2]||(V[2]=[u("没有更多了",-1)])]),_:1}))])])}}},ft=H(mt,[["__scopeId","data-v-e7f24a28"]]);const _t={class:"head"},yt={class:"title"},vt={class:"ops"},kt={style:{"margin-top":"8px","text-align":"right"}},bt={__name:"KeyDetailString",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh","delete"],setup(t,{emit:n}){const a=t,s=n,r=x(""),k=x(!1),b=x(!1);async function p(){r.value=await Ke(a.keyName)||""}async function d(){b.value=!0;try{await De(a.keyName,r.value)}finally{b.value=!1,s("refresh")}}function w(){ElMessageBox.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:h})=>s("rename",{key:a.keyName,newKey:h})).catch(()=>{})}function g(){ElMessageBox.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:h})=>s("expire",{key:a.keyName,ttl:Number(h)})).catch(()=>{})}function V(){k.value=!k.value}return G(p),(h,m)=>{const f=c("el-tag"),v=c("el-button"),_=c("el-input"),i=c("el-popconfirm"),o=c("el-card");return D(),R(o,{shadow:"never",class:"detail"},{header:l(()=>[C("div",_t,[C("div",yt,[u(E(t.keyName)+" ",1),e(f,{size:"small"},{default:l(()=>[...m[3]||(m[3]=[u("string",-1)])]),_:1})]),C("div",vt,[e(v,{size:"small",onClick:V,type:k.value?"warning":"default"},{default:l(()=>[u(E(k.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(v,{size:"small",onClick:w},{default:l(()=>[...m[4]||(m[4]=[u("重命名",-1)])]),_:1}),e(v,{size:"small",onClick:g},{default:l(()=>[...m[5]||(m[5]=[u("设置TTL",-1)])]),_:1}),e(v,{size:"small",onClick:m[0]||(m[0]=L=>s("persist",t.keyName))},{default:l(()=>[...m[6]||(m[6]=[u("移除TTL",-1)])]),_:1}),e(v,{size:"small",type:"primary",onClick:d,disabled:!k.value,loading:b.value},{default:l(()=>[...m[7]||(m[7]=[u("保存",-1)])]),_:1},8,["disabled","loading"])])])]),default:l(()=>[e(_,{modelValue:r.value,"onUpdate:modelValue":m[1]||(m[1]=L=>r.value=L),type:"textarea",rows:20,placeholder:"值...",disabled:!k.value},null,8,["modelValue","disabled"]),C("div",kt,[e(i,{title:"删除该键？",onConfirm:m[2]||(m[2]=L=>s("delete",t.keyName))},{reference:l(()=>[e(v,{size:"small",type:"danger",disabled:!k.value},{default:l(()=>[...m[8]||(m[8]=[u("删除键",-1)])]),_:1},8,["disabled"])]),_:1})])]),_:1})}}},gt=H(bt,[["__scopeId","data-v-e625b302"]]);const ht={class:"head"},wt={class:"title"},xt={class:"ops"},Ct={__name:"KeyDetailHash",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,s=n,r=x([]),k=x(!1);async function b(){const m=await Le(a.keyName,0,200);r.value=m.items||[]}function p(){r.value.unshift({field:"",value:""})}async function d(m){await Me(a.keyName,m.field,m.value),s("refresh")}async function w(m){await Pe(a.keyName,m.field),r.value=r.value.filter(f=>f.field!==m.field),s("refresh")}function g(){ElMessageBox.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:m})=>s("rename",{key:a.keyName,newKey:m})).catch(()=>{})}function V(){ElMessageBox.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:m})=>s("expire",{key:a.keyName,ttl:Number(m)})).catch(()=>{})}function h(){k.value=!k.value}return G(b),(m,f)=>{const v=c("el-tag"),_=c("el-button"),i=c("el-input"),o=c("el-table-column"),L=c("el-popconfirm"),K=c("el-table"),S=c("el-card");return D(),R(S,{shadow:"never",class:"detail"},{header:l(()=>[C("div",ht,[C("div",wt,[u(E(t.keyName)+" ",1),e(v,{size:"small"},{default:l(()=>[...f[1]||(f[1]=[u("hash",-1)])]),_:1})]),C("div",xt,[e(_,{size:"small",onClick:h,type:k.value?"warning":"default"},{default:l(()=>[u(E(k.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(_,{size:"small",onClick:g},{default:l(()=>[...f[2]||(f[2]=[u("重命名",-1)])]),_:1}),e(_,{size:"small",onClick:V},{default:l(()=>[...f[3]||(f[3]=[u("设置TTL",-1)])]),_:1}),e(_,{size:"small",onClick:f[0]||(f[0]=$=>s("persist",t.keyName))},{default:l(()=>[...f[4]||(f[4]=[u("移除TTL",-1)])]),_:1}),e(_,{size:"small",type:"primary",onClick:p,disabled:!k.value},{default:l(()=>[...f[5]||(f[5]=[u("新增字段",-1)])]),_:1},8,["disabled"])])])]),default:l(()=>[e(K,{data:r.value,height:"calc(100% - 10px)"},{default:l(()=>[e(o,{prop:"field",label:"Field","min-width":"200"},{default:l(({row:$})=>[e(i,{modelValue:$.field,"onUpdate:modelValue":M=>$.field=M,placeholder:"字段名",disabled:!k.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(o,{prop:"value",label:"Value","min-width":"300"},{default:l(({row:$})=>[e(i,{modelValue:$.value,"onUpdate:modelValue":M=>$.value=M,disabled:!k.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(o,{label:"操作",width:"200"},{default:l(({row:$})=>[e(_,{size:"small",type:"primary",onClick:M=>d($),disabled:!k.value},{default:l(()=>[...f[6]||(f[6]=[u("保存",-1)])]),_:1},8,["onClick","disabled"]),e(L,{title:"删除该字段？",onConfirm:M=>w($)},{reference:l(()=>[e(_,{size:"small",type:"danger",disabled:!k.value},{default:l(()=>[...f[7]||(f[7]=[u("删除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})}}},Vt=H(Ct,[["__scopeId","data-v-73ecba66"]]);const zt={class:"head"},Nt={class:"title"},Tt={class:"ops"},St={class:"bar"},$t={style:{display:"flex",gap:"8px","align-items":"center"}},Kt={__name:"KeyDetailList",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,s=n,r=x([]),k=x(""),b=x(!1);async function p(){r.value=await Ee(a.keyName,0,100)}async function d(){await Re(a.keyName,k.value),k.value="",await p(),s("refresh")}async function w(){await Be(a.keyName,k.value),k.value="",await p(),s("refresh")}async function g(){await Ie(a.keyName),await p(),s("refresh")}async function V(){await Fe(a.keyName),await p(),s("refresh")}async function h(i,o){await Ue(a.keyName,i,o),await p(),s("refresh")}async function m(i){await Ae(a.keyName,i),await p(),s("refresh")}function f(){ElMessageBox.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:i})=>s("rename",{key:a.keyName,newKey:i})).catch(()=>{})}function v(){ElMessageBox.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:i})=>s("expire",{key:a.keyName,ttl:Number(i)})).catch(()=>{})}G(p);function _(){b.value=!b.value}return(i,o)=>{const L=c("el-tag"),K=c("el-button"),S=c("el-input"),$=c("el-table-column"),M=c("el-popconfirm"),O=c("el-table"),B=c("el-card");return D(),R(B,{shadow:"never",class:"detail"},{header:l(()=>[C("div",zt,[C("div",Nt,[u(E(t.keyName)+" ",1),e(L,{size:"small"},{default:l(()=>[...o[2]||(o[2]=[u("list",-1)])]),_:1})]),C("div",Tt,[e(K,{size:"small",onClick:_,type:b.value?"warning":"default"},{default:l(()=>[u(E(b.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(K,{size:"small",onClick:f},{default:l(()=>[...o[3]||(o[3]=[u("重命名",-1)])]),_:1}),e(K,{size:"small",onClick:v},{default:l(()=>[...o[4]||(o[4]=[u("设置TTL",-1)])]),_:1}),e(K,{size:"small",onClick:o[0]||(o[0]=I=>s("persist",t.keyName))},{default:l(()=>[...o[5]||(o[5]=[u("移除TTL",-1)])]),_:1})])])]),default:l(()=>[C("div",St,[e(S,{modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=I=>k.value=I),style:{width:"60%"},placeholder:"值",disabled:!b.value},null,8,["modelValue","disabled"]),e(K,{size:"small",type:"primary",onClick:d,disabled:!b.value},{default:l(()=>[...o[6]||(o[6]=[u("LPUSH",-1)])]),_:1},8,["disabled"]),e(K,{size:"small",type:"primary",onClick:w,disabled:!b.value},{default:l(()=>[...o[7]||(o[7]=[u("RPUSH",-1)])]),_:1},8,["disabled"]),e(K,{size:"small",onClick:g,disabled:!b.value},{default:l(()=>[...o[8]||(o[8]=[u("LPOP",-1)])]),_:1},8,["disabled"]),e(K,{size:"small",onClick:V,disabled:!b.value},{default:l(()=>[...o[9]||(o[9]=[u("RPOP",-1)])]),_:1},8,["disabled"])]),e(O,{data:r.value,height:"calc(100% - 80px)"},{default:l(()=>[e($,{type:"index",width:"70"}),e($,{prop:"value",label:"Value"},{default:l(({row:I,$index:j})=>[C("div",$t,[e(S,{modelValue:I.value,"onUpdate:modelValue":y=>I.value=y,disabled:!b.value},null,8,["modelValue","onUpdate:modelValue","disabled"]),e(K,{size:"small",type:"primary",onClick:y=>h(j,I.value),disabled:!b.value},{default:l(()=>[...o[10]||(o[10]=[u("保存",-1)])]),_:1},8,["onClick","disabled"]),e(M,{title:"删除该元素？",onConfirm:y=>m(I.value)},{reference:l(()=>[e(K,{size:"small",type:"danger",disabled:!b.value},{default:l(()=>[...o[11]||(o[11]=[u("删除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])])]),_:1})]),_:1},8,["data"])]),_:1})}}},Dt=H(Kt,[["__scopeId","data-v-0424010e"]]);const Lt={class:"head"},Mt={class:"title"},Pt={class:"ops"},Et={class:"bar"},Rt={__name:"KeyDetailSet",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,s=n,r=x([]),k=x(""),b=x(!1),p=x("0");async function d(){const f=await He(a.keyName,p.value,void 0,200);p.value=f.cursor,r.value=f.items||[]}async function w(){await Oe(a.keyName,k.value),k.value="",await d(),s("refresh")}async function g(f){await je(a.keyName,f.member),await d(),s("refresh")}function V(){ElMessageBox.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:f})=>s("rename",{key:a.keyName,newKey:f})).catch(()=>{})}function h(){ElMessageBox.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:f})=>s("expire",{key:a.keyName,ttl:Number(f)})).catch(()=>{})}G(d);function m(){b.value=!b.value}return(f,v)=>{const _=c("el-tag"),i=c("el-button"),o=c("el-input"),L=c("el-table-column"),K=c("el-popconfirm"),S=c("el-table"),$=c("el-card");return D(),R($,{shadow:"never",class:"detail"},{header:l(()=>[C("div",Lt,[C("div",Mt,[u(E(t.keyName)+" ",1),e(_,{size:"small"},{default:l(()=>[...v[2]||(v[2]=[u("set",-1)])]),_:1})]),C("div",Pt,[e(i,{size:"small",onClick:m,type:b.value?"warning":"default"},{default:l(()=>[u(E(b.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(i,{size:"small",onClick:V},{default:l(()=>[...v[3]||(v[3]=[u("重命名",-1)])]),_:1}),e(i,{size:"small",onClick:h},{default:l(()=>[...v[4]||(v[4]=[u("设置TTL",-1)])]),_:1}),e(i,{size:"small",onClick:v[0]||(v[0]=M=>s("persist",t.keyName))},{default:l(()=>[...v[5]||(v[5]=[u("移除TTL",-1)])]),_:1})])])]),default:l(()=>[C("div",Et,[e(o,{modelValue:k.value,"onUpdate:modelValue":v[1]||(v[1]=M=>k.value=M),style:{width:"60%"},placeholder:"成员",disabled:!b.value},null,8,["modelValue","disabled"]),e(i,{size:"small",type:"primary",onClick:w,disabled:!b.value},{default:l(()=>[...v[6]||(v[6]=[u("SADD",-1)])]),_:1},8,["disabled"])]),e(S,{data:r.value,height:"calc(100% - 80px)"},{default:l(()=>[e(L,{prop:"member",label:"Member"}),e(L,{label:"操作",width:"120"},{default:l(({row:M})=>[e(K,{title:"移除该成员？",onConfirm:O=>g(M)},{reference:l(()=>[e(i,{size:"small",type:"danger",disabled:!b.value},{default:l(()=>[...v[7]||(v[7]=[u("移除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})}}},Bt=H(Rt,[["__scopeId","data-v-1e26c953"]]);const It={class:"head"},Ft={class:"title"},Ut={class:"ops"},At={class:"bar"},Ht={__name:"KeyDetailZSet",props:{keyName:String,keyType:String},emits:["rename","expire","persist","refresh"],setup(t,{emit:n}){const a=t,s=n,r=x([]),k=x(""),b=x(0),p=x(!1);async function d(){r.value=await qe(a.keyName,0,200)}async function w(){await Ze(a.keyName,k.value,Number(b.value)),k.value="",b.value=0,await d(),s("refresh")}async function g(v){await Ge(a.keyName,v.member),await d(),s("refresh")}async function V(v){await Je(a.keyName,v.member,.1),await d(),s("refresh")}function h(){ElMessageBox.prompt("输入新的 Key 名称","重命名",{inputValue:a.keyName}).then(({value:v})=>s("rename",{key:a.keyName,newKey:v})).catch(()=>{})}function m(){ElMessageBox.prompt("设置 TTL（秒），-1 取消","TTL",{inputValue:"3600"}).then(({value:v})=>s("expire",{key:a.keyName,ttl:Number(v)})).catch(()=>{})}G(d);function f(){p.value=!p.value}return(v,_)=>{const i=c("el-tag"),o=c("el-button"),L=c("el-input-number"),K=c("el-input"),S=c("el-table-column"),$=c("el-popconfirm"),M=c("el-table"),O=c("el-card");return D(),R(O,{shadow:"never",class:"detail"},{header:l(()=>[C("div",It,[C("div",Ft,[u(E(t.keyName)+" ",1),e(i,{size:"small"},{default:l(()=>[..._[3]||(_[3]=[u("zset",-1)])]),_:1})]),C("div",Ut,[e(o,{size:"small",onClick:f,type:p.value?"warning":"default"},{default:l(()=>[u(E(p.value?"完成编辑":"编辑"),1)]),_:1},8,["type"]),e(o,{size:"small",onClick:h},{default:l(()=>[..._[4]||(_[4]=[u("重命名",-1)])]),_:1}),e(o,{size:"small",onClick:m},{default:l(()=>[..._[5]||(_[5]=[u("设置TTL",-1)])]),_:1}),e(o,{size:"small",onClick:_[0]||(_[0]=B=>s("persist",t.keyName))},{default:l(()=>[..._[6]||(_[6]=[u("移除TTL",-1)])]),_:1})])])]),default:l(()=>[C("div",At,[e(L,{modelValue:b.value,"onUpdate:modelValue":_[1]||(_[1]=B=>b.value=B),min:-999999,max:999999,disabled:!p.value},null,8,["modelValue","disabled"]),e(K,{modelValue:k.value,"onUpdate:modelValue":_[2]||(_[2]=B=>k.value=B),style:{width:"60%"},placeholder:"成员",disabled:!p.value},null,8,["modelValue","disabled"]),e(o,{size:"small",type:"primary",onClick:w,disabled:!p.value},{default:l(()=>[..._[7]||(_[7]=[u("ZADD",-1)])]),_:1},8,["disabled"])]),e(M,{data:r.value,height:"calc(100% - 80px)"},{default:l(()=>[e(S,{prop:"score",label:"Score",width:"100"}),e(S,{prop:"member",label:"Member"}),e(S,{label:"操作",width:"160"},{default:l(({row:B})=>[e(o,{size:"small",onClick:I=>V(B),disabled:!p.value},{default:l(()=>[..._[8]||(_[8]=[u("+0.1",-1)])]),_:1},8,["onClick","disabled"]),e($,{title:"移除该成员？",onConfirm:I=>g(B)},{reference:l(()=>[e(o,{size:"small",type:"danger",disabled:!p.value},{default:l(()=>[..._[9]||(_[9]=[u("移除",-1)])]),_:1},8,["disabled"])]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})}}},Ot=H(Ht,[["__scopeId","data-v-767d4466"]]);const jt={class:"sidebar-content"},qt={class:"header-left"},Zt={class:"header-right"},Gt={__name:"RedisExplorer",setup(t){const n=Qe(),a=ge(),s=x(!1),r=F(()=>n.profiles),k=F(()=>n.currentProfileId),b=F(()=>n.connecting),p=F(()=>n.connected),d=F(()=>n.pattern),w=F(()=>n.typeFilter),g=F(()=>n.scanning),V=F(()=>n.keys),h=F(()=>n.hasMore),m=F(()=>n.selectedKey),f=F(()=>n.selectedType),v=F(()=>{switch(f.value){case"string":return gt;case"hash":return Vt;case"list":return Dt;case"set":return Bt;case"zset":return Ot;default:return null}});function _(N){n.saveProfile(N)}function i(N){n.deleteProfile(N)}function o(N){n.connect(N)}function L(){n.disconnect()}function K(N){n.selectProfile(N)}function S(N){n.search(N)}function $(){n.search({pattern:d.value,type:w.value})}function M(){n.resetSearch()}function O(){n.loadMore()}function B(N){n.selectKey(N)}function I(N){n.deleteKey(N)}function j({key:N,newKey:A}){n.renameKey(N,A)}function y({key:N,ttl:A}){n.expireKey(N,A)}function P(N){n.persistKey(N)}function U(){n.refreshSelected()}function q(){s.value=!s.value}function J(){a.push({name:"Dashboard"})}function Q(){a.push({name:"Dashboard",query:{openMqtt:1}})}return G(()=>{n.init()}),(N,A)=>{const oe=c("el-aside"),W=c("el-button"),se=c("el-header"),Y=c("el-col"),ie=c("el-empty"),de=c("el-row"),ue=c("el-main"),ee=c("el-container");return D(),R(ee,{style:{height:"100%"}},{default:l(()=>[e(oe,{width:s.value?"0px":"320px",class:ne(["redis-aside",{collapsed:s.value}])},{default:l(()=>[he(C("div",jt,[e(at,{profiles:r.value,currentProfileId:k.value,connecting:b.value,connected:p.value,onSave:_,onDelete:i,onConnect:o,onDisconnect:L,onSelect:K},null,8,["profiles","currentProfileId","connecting","connected"])],512),[[we,!s.value]])]),_:1},8,["width","class"]),e(ee,null,{default:l(()=>[e(se,{class:"redis-header"},{default:l(()=>[C("div",qt,[e(W,{icon:s.value?"Expand":"Fold",onClick:q,class:"collapse-btn",circle:"",size:"small"},null,8,["icon"]),e(it,{pattern:d.value,typeFilter:w.value,loading:g.value,onSearch:S,onRefresh:$,onReset:M},null,8,["pattern","typeFilter","loading"])]),C("div",Zt,[e(W,{onClick:J},{default:l(()=>[...A[0]||(A[0]=[u("返回仪表盘",-1)])]),_:1}),e(W,{type:"primary",onClick:Q},{default:l(()=>[...A[1]||(A[1]=[u("仪表盘打开MQTT",-1)])]),_:1})])]),_:1}),e(ue,{class:"redis-main"},{default:l(()=>[e(de,{gutter:12,style:{height:"100%"}},{default:l(()=>[e(Y,{span:6,style:{height:"100%"}},{default:l(()=>[e(ft,{items:V.value,hasMore:h.value,loading:g.value,onLoadMore:O,onSelect:B},null,8,["items","hasMore","loading"])]),_:1}),e(Y,{span:18,style:{height:"100%"}},{default:l(()=>[m.value?(D(),R(xe(v.value),{key:m.value+":"+f.value,keyName:m.value,keyType:f.value,onRename:j,onExpire:y,onPersist:P,onDelete:I,onRefresh:U},null,40,["keyName","keyType"])):(D(),R(ie,{key:1,description:"请选择一个键以查看详情"}))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},Qt=H(Gt,[["__scopeId","data-v-6538777d"]]);export{Qt as default};
