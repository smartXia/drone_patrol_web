import{_ as ee,r as i,m as V,v as te,b as r,o as _,c as m,e as o,f as l,w as s,a as ae,A as le,u as se,C as oe,F as U,h as B,t as c,g,s as ne,i as re}from"./index-4a650b41.js";const ce={class:"error-codes-container"},ie={class:"header"},ue={class:"search-section"},de={class:"stats"},pe={class:"stat-item"},ve={class:"stat-value"},_e={class:"stat-item"},ge={class:"stat-value"},fe={class:"content"},me={class:"description-cell"},ye=["innerHTML"],be={class:"pagination"},he={key:0,class:"code-detail"},Ce={class:"description-section"},we={class:"suggestions-section"},ke={__name:"ErrorCodes",setup(Ve){const d=i(""),y=i(""),u=i(1),f=i(50),w=i(!1),n=i(null),b=i([]),x=i([{value:"upgrade",label:"设备升级"},{value:"flight",label:"飞行任务"},{value:"communication",label:"通信异常"},{value:"battery",label:"电池相关"},{value:"rtk",label:"RTK定位"},{value:"camera",label:"相机相关"},{value:"media",label:"媒体文件"},{value:"system",label:"系统异常"},{value:"network",label:"网络相关"},{value:"weather",label:"天气环境"},{value:"other",label:"其他"}]),I=V(()=>b.value.length),k=V(()=>{let t=b.value;if(y.value&&(t=t.filter(e=>e.category===y.value)),d.value){const e=d.value.toLowerCase();t=t.filter(p=>p.code.includes(e)||p.description.toLowerCase().includes(e))}return t}),$=V(()=>{const t=(u.value-1)*f.value,e=t+f.value;return k.value.slice(t,e)}),A=async()=>{try{const t=await ae.get(`${le}/api/error-codes`);if(t.data.code===0)b.value=t.data.data;else throw new Error(t.data.message)}catch(t){console.error("加载错误码失败:",t),b.value=[{code:"312014",description:"设备升级中，请勿重复操作",category:"upgrade",severity:"warning"},{code:"314001",description:"飞行任务下发失败，请稍后重试",category:"flight",severity:"error"}]}},z=t=>{const e=x.value.find(p=>p.value===t);return e?e.label:"其他"},S=t=>({error:"严重",warning:"警告",success:"正常",info:"信息"})[t]||"未知",E=t=>{const e=parseInt(t);return e>=312e3&&e<315e3?"primary":e>=314e3&&e<317e3?"danger":e>=315e3&&e<316e3?"warning":e>=316e3&&e<317e3?"success":e>=317e3&&e<319e3?"info":"default"},L=t=>({upgrade:"primary",flight:"danger",communication:"warning",battery:"success",rtk:"info",camera:"primary",media:"info",system:"danger",network:"warning",weather:"success",other:"default"})[t]||"default",T=t=>({error:"danger",warning:"warning",success:"success",info:"info"})[t]||"default",D=({row:t})=>`severity-${t.severity}`,M=t=>{if(!d.value)return t;const e=new RegExp(`(${d.value})`,"gi");return t.replace(e,"<mark>$1</mark>")},P=()=>{u.value=1},F=()=>{u.value=1},H=t=>{f.value=t,u.value=1},j=t=>{u.value=t},q=t=>{n.value=t,w.value=!0},J=t=>({312014:"等待升级完成",314001:"检查网络连接后重试",315e3:"重启机场设备",316009:"给飞行器充电",319002:"重启机场系统"})[t]||"请根据错误描述采取相应措施",K=t=>({312014:["等待当前升级任务完成","检查设备状态指示灯","确保网络连接稳定"],314001:["检查网络连接状态","确认机场设备在线","稍后重新下发任务"],315e3:["重启机场设备","检查电源连接","联系技术支持"],316009:["给飞行器充电至50%以上","检查电池状态","等待充电完成"]})[t]||["根据错误描述检查相关设备","重启相关设备后重试","如问题持续请联系技术支持"];return te(()=>{A()}),(t,e)=>{var R;const p=r("el-icon"),Q=r("el-input"),G=r("el-option"),O=r("el-select"),N=r("el-card"),v=r("el-tag"),h=r("el-table-column"),W=r("el-table"),X=r("el-pagination"),C=r("el-descriptions-item"),Y=r("el-descriptions"),Z=r("el-dialog");return _(),m("div",ce,[o("div",ie,[e[5]||(e[5]=o("h1",null,"DJI 错误码查询",-1)),o("div",ue,[l(Q,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),placeholder:"搜索错误码或描述...",clearable:"",onInput:P,class:"search-input"},{prefix:s(()=>[l(p,null,{default:s(()=>[l(se(oe))]),_:1})]),_:1},8,["modelValue"]),l(O,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),placeholder:"选择分类",clearable:"",onChange:F,class:"category-select"},{default:s(()=>[(_(!0),m(U,null,B(x.value,a=>(_(),re(G,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),o("div",de,[l(N,{class:"stat-card"},{default:s(()=>[o("div",pe,[e[6]||(e[6]=o("span",{class:"stat-label"},"总错误码数",-1)),o("span",ve,c(I.value),1)])]),_:1}),l(N,{class:"stat-card"},{default:s(()=>[o("div",_e,[e[7]||(e[7]=o("span",{class:"stat-label"},"搜索结果",-1)),o("span",ge,c(k.value.length),1)])]),_:1})]),o("div",fe,[l(W,{data:$.value,stripe:"",border:"",height:"600","row-class-name":D,onRowClick:q,class:"error-table"},{default:s(()=>[l(h,{prop:"code",label:"错误码",width:"120",fixed:"left"},{default:s(({row:a})=>[l(v,{type:E(a.code),class:"code-tag"},{default:s(()=>[g(c(a.code),1)]),_:2},1032,["type"])]),_:1}),l(h,{prop:"description",label:"错误描述","min-width":"400"},{default:s(({row:a})=>[o("div",me,[o("span",{innerHTML:M(a.description)},null,8,ye)])]),_:1}),l(h,{prop:"category",label:"分类",width:"120"},{default:s(({row:a})=>[l(v,{type:L(a.category),size:"small"},{default:s(()=>[g(c(z(a.category)),1)]),_:2},1032,["type"])]),_:1}),l(h,{prop:"severity",label:"严重程度",width:"100"},{default:s(({row:a})=>[l(v,{type:T(a.severity),size:"small"},{default:s(()=>[g(c(S(a.severity)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"]),o("div",be,[l(X,{"current-page":u.value,"onUpdate:currentPage":e[2]||(e[2]=a=>u.value=a),"page-size":f.value,"onUpdate:pageSize":e[3]||(e[3]=a=>f.value=a),"page-sizes":[20,50,100,200],total:k.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:j},null,8,["current-page","page-size","total"])])]),l(Z,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=a=>w.value=a),title:`错误码 ${(R=n.value)==null?void 0:R.code} 详情`,width:"60%",class:"detail-dialog"},{default:s(()=>[n.value?(_(),m("div",he,[l(Y,{column:2,border:""},{default:s(()=>[l(C,{label:"错误码"},{default:s(()=>[l(v,{type:E(n.value.code),size:"large"},{default:s(()=>[g(c(n.value.code),1)]),_:1},8,["type"])]),_:1}),l(C,{label:"分类"},{default:s(()=>[l(v,{type:L(n.value.category)},{default:s(()=>[g(c(z(n.value.category)),1)]),_:1},8,["type"])]),_:1}),l(C,{label:"严重程度"},{default:s(()=>[l(v,{type:T(n.value.severity)},{default:s(()=>[g(c(S(n.value.severity)),1)]),_:1},8,["type"])]),_:1}),l(C,{label:"建议操作"},{default:s(()=>[o("span",null,c(J(n.value.code)),1)]),_:1})]),_:1}),o("div",Ce,[e[8]||(e[8]=o("h4",null,"详细描述",-1)),o("p",null,c(n.value.description),1)]),o("div",we,[e[9]||(e[9]=o("h4",null,"解决建议",-1)),o("ul",null,[(_(!0),m(U,null,B(K(n.value.code),a=>(_(),m("li",{key:a},c(a),1))),128))])])])):ne("",!0)]),_:1},8,["modelValue","title"])])}}},ze=ee(ke,[["__scopeId","data-v-6331fe0c"]]);export{ze as default};
